<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vrindopnishad - Enhanced Web Data Manager</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .header p {
            color: #666;
            font-size: 1.1rem;
        }

        .message {
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            animation: slideIn 0.3s ease;
        }

        .message-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .message-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }

        .message-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 8px;
            margin-bottom: 24px;
            overflow-x: auto;
        }

        .tab {
            flex: 1;
            min-width: 120px;
            padding: 12px 16px;
            background: none;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            text-align: center;
        }

        .tab.active {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
        }

        .tab:hover:not(.active) {
            background: rgba(30, 60, 114, 0.1);
        }

        .content-section {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }

        .content-section.active {
            display: block;
        }

        .content-section h2 {
            margin-bottom: 24px;
            color: #1e3c72;
            font-size: 1.8rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s ease;
            background: white;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #1e3c72;
            box-shadow: 0 0 0 3px rgba(30, 60, 114, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        .search-controls {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-group {
            flex: 1;
            min-width: 200px;
        }

        .search-group input,
        .search-group select {
            padding: 10px 14px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            width: 100%;
        }

        .btn {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-right: 12px;
            margin-bottom: 12px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(30, 60, 114, 0.4);
        }

        .btn-secondary { background: linear-gradient(135deg, #6c757d, #828a91); }
        .btn-success { background: linear-gradient(135deg, #28a745, #34ce57); }
        .btn-danger { background: linear-gradient(135deg, #dc3545, #e4606d); }
        .btn-warning { background: linear-gradient(135deg, #ffc107, #ffcd39); color: #333; }
        .btn-info { background: linear-gradient(135deg, #17a2b8, #20c997); }
        .btn-sm { padding: 8px 16px; font-size: 12px; }

        .item-list {
            display: grid;
            gap: 16px;
            margin-top: 20px;
        }

        .item-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.2s ease;
        }

        .item-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            gap: 16px;
        }

        .item-title {
            font-weight: 600;
            color: #1e3c72;
            font-size: 1.1rem;
            line-height: 1.3;
        }

        .item-actions {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
            flex-wrap: wrap;
        }

        .item-meta {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .item-categories {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin: 12px 0;
        }

        .item-category {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            color: #1565c0;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            border: 1px solid #90caf9;
        }

        .item-description {
            color: #555;
            line-height: 1.5;
            margin-top: 12px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: transform 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            margin-top: 4px;
        }

        .category-manager {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .category-manager h3 {
            margin-bottom: 16px;
            color: #1e3c72;
        }

        .category-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
        }

        .category-tag {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .category-tag:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(30, 60, 114, 0.3);
        }

        .category-tag .remove-category {
            background: rgba(255, 255, 255, 0.3);
            border: none;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            cursor: pointer;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .add-category-form {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .add-category-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .add-category-btn {
            padding: 8px 16px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s ease;
        }

        .add-category-btn:hover {
            background: #218838;
        }

        .cross-ref-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .cross-ref-section {
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 16px;
        }

        .cross-ref-section h4 {
            color: #1e3c72;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 16px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .tabs {
                flex-direction: column;
            }

            .tab {
                text-align: left;
            }

            .item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .item-actions {
                width: 100%;
                justify-content: flex-start;
            }

            .search-controls {
                flex-direction: column;
            }

            .cross-ref-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>Enhanced Unified Web Data Manager</h1>
            <p>Advanced content management with dynamic categories and cross-referencing</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalBooks">0</div>
                <div class="stat-label">Books</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalImages">0</div>
                <div class="stat-label">Images</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalAudio">0</div>
                <div class="stat-label">Audio Tracks</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalContent">0</div>
                <div class="stat-label">Content Items</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('books')">
                <i class="fas fa-book"></i> Books
            </button>
            <button class="tab" onclick="showTab('images')">
                <i class="fas fa-image"></i> Images
            </button>
            <button class="tab" onclick="showTab('audio')">
                <i class="fas fa-music"></i> Audio
            </button>
            <button class="tab" onclick="showTab('content')">
                <i class="fas fa-file-text"></i> Content
            </button>
            <button class="tab" onclick="showTab('categories')">
                <i class="fas fa-tags"></i> Categories
            </button>
            <button class="tab" onclick="showTab('api')">
                <i class="fas fa-code"></i> API & Export
            </button>
        </div>

        <!-- Books Section -->
        <div id="books" class="content-section active">
            <h2><i class="fas fa-book"></i> Books Management</h2>
            
            <div class="search-controls">
                <div class="search-group">
                    <input type="text" id="booksSearch" placeholder="Search books..." onkeyup="searchBooks()">
                </div>
                <div class="search-group">
                    <select id="booksFilter" onchange="filterBooks()">
                        <option value="all">All Categories</option>
                    </select>
                </div>
            </div>

            <div class="form-grid">
                <div>
                    <h3>Add New Book</h3>
                    <form id="bookForm">
                        <div class="form-group">
                            <label for="bookTitle">Title *</label>
                            <input type="text" id="bookTitle" required>
                        </div>
                        <div class="form-group">
                            <label for="bookAuthor">Author *</label>
                            <input type="text" id="bookAuthor" required>
                        </div>
                        <div class="form-group">
                            <label for="bookCategory">Category *</label>
                            <select id="bookCategory" required>
                                <option value="">Select a category</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="bookYear">Year</label>
                            <input type="text" id="bookYear">
                        </div>
                        <div class="form-group">
                            <label for="bookLanguage">Language</label>
                            <select id="bookLanguage">
                                <option value="sanskrit">Sanskrit</option>
                                <option value="english">English</option>
                                <option value="hindi">Hindi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="bookCover">Cover Image URL</label>
                            <input type="url" id="bookCover">
                        </div>
                        <div class="form-group">
                            <label for="bookDescription">Description</label>
                            <textarea id="bookDescription"></textarea>
                        </div>
                        <div class="form-group">
                            <button type="submit" id="saveBookBtn" class="btn">
                                <i class="fas fa-save"></i> Add Book
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearBookForm()">
                                <i class="fas fa-times"></i> Clear
                            </button>
                        </div>
                    </form>
                </div>
                <div>
                    <h3>Books List</h3>
                    <div id="booksList" class="item-list"></div>
                </div>
            </div>
        </div>

        <!-- Images Section -->
        <div id="images" class="content-section">
            <h2><i class="fas fa-image"></i> Images Management</h2>
            
            <div class="search-controls">
                <div class="search-group">
                    <input type="text" id="imagesSearch" placeholder="Search images..." onkeyup="searchImages()">
                </div>
                <div class="search-group">
                    <select id="imageFilter" onchange="filterImages()">
                        <option value="all">All Categories</option>
                    </select>
                </div>
            </div>

            <div class="form-grid">
                <div>
                    <h3>Add New Image</h3>
                    <form id="imageForm">
                        <div class="form-group">
                            <label for="imageTitle">Title *</label>
                            <input type="text" id="imageTitle" required>
                        </div>
                        <div class="form-group">
                            <label for="imageSrc">Image URL *</label>
                            <input type="url" id="imageSrc" required>
                        </div>
                        <div class="form-group">
                            <label for="imageCategory">Category *</label>
                            <select id="imageCategory" required>
                                <option value="">Select a category</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="imageAlt">Alt Text</label>
                            <input type="text" id="imageAlt">
                        </div>
                        <div class="form-group">
                            <label for="imageDescription">Description</label>
                            <textarea id="imageDescription"></textarea>
                        </div>
                        <div class="form-group">
                            <button type="submit" id="saveImageBtn" class="btn">
                                <i class="fas fa-save"></i> Add Image
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearImageForm()">
                                <i class="fas fa-times"></i> Clear
                            </button>
                        </div>
                    </form>
                </div>
                <div>
                    <h3>Images List</h3>
                    <div id="imagesList" class="item-list"></div>
                </div>
            </div>
        </div>

        <!-- Audio Section -->
        <div id="audio" class="content-section">
            <h2><i class="fas fa-music"></i> Audio Management</h2>
            
            <div class="search-controls">
                <div class="search-group">
                    <input type="text" id="audioSearch" placeholder="Search audio..." onkeyup="searchAudio()">
                </div>
                <div class="search-group">
                    <select id="audioFilter" onchange="filterAudio()">
                        <option value="all">All Categories</option>
                    </select>
                </div>
            </div>

            <div class="form-grid">
                <div>
                    <h3>Add New Audio</h3>
                    <form id="audioForm">
                        <div class="form-group">
                            <label for="audioTitle">Title *</label>
                            <input type="text" id="audioTitle" required>
                        </div>
                        <div class="form-group">
                            <label for="audioSrc">Audio URL *</label>
                            <input type="url" id="audioSrc" required>
                        </div>
                        <div class="form-group">
                            <label for="audioCategory">Category *</label>
                            <select id="audioCategory" required>
                                <option value="">Select a category</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="audioArtist">Artist</label>
                            <input type="text" id="audioArtist">
                        </div>
                        <div class="form-group">
                            <label for="audioDuration">Duration</label>
                            <input type="text" id="audioDuration" placeholder="2:45">
                        </div>
                        <div class="form-group">
                            <label for="audioDescription">Description</label>
                            <textarea id="audioDescription"></textarea>
                        </div>
                        <div class="form-group">
                            <button type="submit" id="saveAudioBtn" class="btn">
                                <i class="fas fa-save"></i> Add Audio
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearAudioForm()">
                                <i class="fas fa-times"></i> Clear
                            </button>
                        </div>
                    </form>
                </div>
                <div>
                    <h3>Audio List</h3>
                    <div id="audioList" class="item-list"></div>
                </div>
            </div>
        </div>

        <!-- Content Section -->
        <div id="content" class="content-section">
            <h2><i class="fas fa-file-text"></i> Content Management</h2>
            
            <div class="search-controls">
                <div class="search-group">
                    <input type="text" id="contentSearch" placeholder="Search content..." onkeyup="searchContent()">
                </div>
                <div class="search-group">
                    <select id="contentFilter" onchange="filterContent()">
                        <option value="all">All Categories</option>
                    </select>
                </div>
            </div>

            <div class="form-grid">
                <div>
                    <h3>Add New Content</h3>
                    <form id="contentForm">
                        <div class="form-group">
                            <label for="contentTitle">Title *</label>
                            <input type="text" id="contentTitle" required>
                        </div>
                        <div class="form-group">
                            <label for="contentCategory">Category *</label>
                            <select id="contentCategory" required>
                                <option value="">Select a category</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="contentType">Type</label>
                            <select id="contentType">
                                <option value="page">Page</option>
                                <option value="post">Post</option>
                                <option value="article">Article</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="contentStatus">Status</label>
                            <select id="contentStatus">
                                <option value="draft">Draft</option>
                                <option value="published">Published</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="contentBody">Content Body</label>
                            <textarea id="contentBody" rows="8"></textarea>
                        </div>
                        <div class="form-group">
                            <button type="submit" id="saveContentBtn" class="btn">
                                <i class="fas fa-save"></i> Add Content
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearContentForm()">
                                <i class="fas fa-times"></i> Clear
                            </button>
                        </div>
                    </form>
                </div>
                <div>
                    <h3>Content List</h3>
                    <div id="contentList" class="item-list"></div>
                </div>
            </div>
        </div>

        <!-- Categories Management Section -->
        <div id="categories" class="content-section">
            <h2><i class="fas fa-tags"></i> Category Management</h2>
            
            <div class="cross-ref-grid">
                <div class="cross-ref-section">
                    <h4><i class="fas fa-book"></i> Books Categories</h4>
                    <div class="category-list" id="globalBookCategories"></div>
                    <div class="add-category-form">
                        <input type="text" id="globalNewBookCategory" class="add-category-input" placeholder="Add book category...">
                        <button onclick="addCategory('books', true)" class="add-category-btn">Add</button>
                    </div>
                </div>
                
                <div class="cross-ref-section">
                    <h4><i class="fas fa-image"></i> Image Categories</h4>
                    <div class="category-list" id="globalImageCategories"></div>
                    <div class="add-category-form">
                        <input type="text" id="globalNewImageCategory" class="add-category-input" placeholder="Add image category...">
                        <button onclick="addCategory('images', true)" class="add-category-btn">Add</button>
                    </div>
                </div>
                
                <div class="cross-ref-section">
                    <h4><i class="fas fa-music"></i> Audio Categories</h4>
                    <div class="category-list" id="globalAudioCategories"></div>
                    <div class="add-category-form">
                        <input type="text" id="globalNewAudioCategory" class="add-category-input" placeholder="Add audio category...">
                        <button onclick="addCategory('audio', true)" class="add-category-btn">Add</button>
                    </div>
                </div>
                
                <div class="cross-ref-section">
                    <h4><i class="fas fa-file-text"></i> Content Categories</h4>
                    <div class="category-list" id="globalContentCategories"></div>
                    <div class="add-category-form">
                        <input type="text" id="globalNewContentCategory" class="add-category-input" placeholder="Add content category...">
                        <button onclick="addCategory('content', true)" class="add-category-btn">Add</button>
                    </div>
                </div>
            </div>

            <div style="margin-top: 30px;">
                <h3><i class="fas fa-link"></i> Cross-Reference Tool</h3>
                <p style="color: #666; margin-bottom: 20px;">Click on any item in the lists above to see related content across all categories.</p>
                <div id="crossReferenceResults"></div>
            </div>
        </div>

        <!-- API & Export Section -->
        <div id="api" class="content-section">
            <h2><i class="fas fa-code"></i> API & Data Export</h2>
            
            <div style="background: #e7f3ff; border: 1px solid #b6d7ff; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                <h3>Enhanced API Features:</h3>
                <pre>// Get items by category
const vedicBooks = UnifiedAPI.getBooks('vedic');
const spiritualImages = UnifiedAPI.getImages('spiritual');

// Get category statistics
const stats = UnifiedAPI.getCategoryStats();

// Find related content across types
const related = UnifiedAPI.findRelatedContent('item-id');

// Category management
UnifiedAPI.addCategory('books', 'new-category');
UnifiedAPI.removeCategory('books', 'old-category');</pre>
            </div>

            <div style="display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap;">
                <button class="btn" onclick="exportAllData()">
                    <i class="fas fa-download"></i> Export All (Unified)
                </button>
                <button class="btn btn-secondary" onclick="exportBooks()">
                    <i class="fas fa-book"></i> Export Books (Unified)
                </button>
                <button class="btn btn-secondary" onclick="exportImages()">
                    <i class="fas fa-image"></i> Export Images (Unified)
                </button>
                <button class="btn btn-secondary" onclick="exportAudio()">
                    <i class="fas fa-music"></i> Export Audio (Unified)
                </button>
                <button class="btn btn-secondary" onclick="exportContent()">
                    <i class="fas fa-file-text"></i> Export Content (Unified)
                </button>
                <br>
                <button class="btn btn-info" onclick="exportAllDataLegacy()">
                    <i class="fas fa-archive"></i> Export All (Legacy)
                </button>
                <button class="btn btn-secondary" onclick="exportCategories()">
                    <i class="fas fa-tags"></i> Export Categories
                </button>
                <button class="btn btn-warning" onclick="importData()">
                    <i class="fas fa-upload"></i> Import Data
                </button>
                <button class="btn btn-danger" onclick="clearAllData()">
                    <i class="fas fa-trash"></i> Clear All Data
                </button>
            </div>

            <div style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 16px; margin-top: 20px; max-height: 400px; overflow-y: auto;">
                <h3>Current Data Structure:</h3>
                <pre id="dataPreview">Loading...</pre>
            </div>
        </div>
    </div>

    <script>
        class EnhancedUnifiedDataManager {
            constructor() {
                this.data = this.loadData();
                this.categories = this.loadCategories();
                this.currentEditingItem = null;
                this.currentEditingType = null;
                this.init();
            }

            init() {
                this.bindEventListeners();
                this.updateStats();
                this.updateCategories();
                this.loadInitialData();
                this.updatePreview();
            }

            loadData() {
                const defaultData = {
                    books: [],
                    images: [],
                    audio: [],
                    content: [],
                    siteConfig: {
                        siteName: "Vrindopnishad",
                        tagline: "Enhanced Spiritual & Divine Collection",
                        description: "Discover and manage sacred content with advanced categorization."
                    }
                };

                const stored = localStorage.getItem('enhancedUnifiedWebData');
                return stored ? JSON.parse(stored) : defaultData;
            }

            loadCategories() {
                const defaultCategories = {
                    books: [],
                    images: [],
                    audio: [],
                    content: []
                };

                const stored = localStorage.getItem('enhancedUnifiedCategories');
                return stored ? JSON.parse(stored) : defaultCategories;
            }

            saveData(showMessage = true) {
                localStorage.setItem('enhancedUnifiedWebData', JSON.stringify(this.data));
                localStorage.setItem('enhancedUnifiedCategories', JSON.stringify(this.categories));
                this.updatePreview();
                this.updateStats();
                if (showMessage) {
                    this.showMessage('Data saved successfully!', 'success');
                }
            }

            bindEventListeners() {
                this.bindFormListener('bookForm', this.handleBookSubmit.bind(this));
                this.bindFormListener('imageForm', this.handleImageSubmit.bind(this));
                this.bindFormListener('audioForm', this.handleAudioSubmit.bind(this));
                this.bindFormListener('contentForm', this.handleContentSubmit.bind(this));

                setInterval(() => {
                    this.saveData(false);
                }, 30000);
            }

            bindFormListener(formId, handler) {
                const form = document.getElementById(formId);
                if (form) {
                    form.addEventListener('submit', handler);
                }
            }

            addCategory(type, isGlobal = false) {
                let inputId;
                
                if (isGlobal) {
                    switch(type) {
                        case 'books': inputId = 'globalNewBookCategory'; break;
                        case 'images': inputId = 'globalNewImageCategory'; break;
                        case 'audio': inputId = 'globalNewAudioCategory'; break;
                        case 'content': inputId = 'globalNewContentCategory'; break;
                    }
                }
                
                const input = document.getElementById(inputId);
                if (!input) {
                    this.showMessage('Error: Input field not found!', 'error');
                    return;
                }
                
                const newCategory = input.value.trim().toLowerCase();
                
                if (newCategory && !this.categories[type].includes(newCategory)) {
                    this.categories[type].push(newCategory);
                    this.categories[type].sort();
                    this.updateCategories();
                    this.saveData();
                    input.value = '';
                    this.showMessage(`Category "${newCategory}" added to ${type}!`, 'success');
                } else if (this.categories[type].includes(newCategory)) {
                    this.showMessage('Category already exists!', 'warning');
                } else {
                    this.showMessage('Please enter a category name!', 'error');
                }
            }

            removeCategory(type, category) {
                if (confirm(`Are you sure you want to remove "${category}" category?`)) {
                    this.categories[type] = this.categories[type].filter(cat => cat !== category);
                    
                    this.data[type].forEach(item => {
                        if (item.category === category) {
                            item.category = 'uncategorized';
                        }
                    });
                    
                    this.updateCategories();
                    this.saveData();
                    this.loadInitialData();
                    this.showMessage(`Category "${category}" removed!`, 'success');
                }
            }

            updateCategories() {
                Object.keys(this.categories).forEach(type => {
                    this.updateCategoryDropdown(type);
                    this.updateCategoryList(type);
                    this.updateCategoryFilter(type);
                });
            }

            updateCategoryDropdown(type) {
                let dropdownId;
                switch(type) {
                    case 'books': dropdownId = 'bookCategory'; break;
                    case 'images': dropdownId = 'imageCategory'; break;
                    case 'audio': dropdownId = 'audioCategory'; break;
                    case 'content': dropdownId = 'contentCategory'; break;
                }
                
                const dropdown = document.getElementById(dropdownId);
                if (dropdown) {
                    dropdown.innerHTML = '<option value="">Select a category</option>';
                    
                    this.categories[type].forEach(category => {
                        const option = document.createElement('option');
                        option.value = category;
                        option.textContent = category.charAt(0).toUpperCase() + category.slice(1);
                        dropdown.appendChild(option);
                    });
                }
            }

            updateCategoryList(type) {
                let globalListId;
                switch(type) {
                    case 'books': globalListId = 'globalBookCategories'; break;
                    case 'images': globalListId = 'globalImageCategories'; break;
                    case 'audio': globalListId = 'globalAudioCategories'; break;
                    case 'content': globalListId = 'globalContentCategories'; break;
                }
                
                const container = document.getElementById(globalListId);
                if (container) {
                    container.innerHTML = '';
                    this.categories[type].forEach(category => {
                        const tag = document.createElement('div');
                        tag.className = 'category-tag';
                        tag.innerHTML = `
                            <span>${category}</span>
                            <button class="remove-category" onclick="dataManager.removeCategory('${type}', '${category}')" title="Remove category">×</button>
                        `;
                        container.appendChild(tag);
                    });
                }
            }

            updateCategoryFilter(type) {
                let filterId;
                switch(type) {
                    case 'books': filterId = 'booksFilter'; break;
                    case 'images': filterId = 'imageFilter'; break;
                    case 'audio': filterId = 'audioFilter'; break;
                    case 'content': filterId = 'contentFilter'; break;
                }
                
                const filter = document.getElementById(filterId);
                if (filter) {
                    const currentValue = filter.value;
                    filter.innerHTML = '<option value="all">All Categories</option>';
                    this.categories[type].forEach(category => {
                        const option = document.createElement('option');
                        option.value = category;
                        option.textContent = category.charAt(0).toUpperCase() + category.slice(1);
                        filter.appendChild(option);
                    });
                    filter.value = currentValue;
                }
            }

            handleBookSubmit(e) {
                e.preventDefault();
                const formData = this.getFormData('book');
                
                if (this.currentEditingItem && this.currentEditingType === 'book') {
                    this.updateBook(this.currentEditingItem.id, formData);
                } else {
                    this.addBook(formData);
                }
                
                this.clearBookForm();
                this.displayBooks();
            }

            handleImageSubmit(e) {
                e.preventDefault();
                const formData = this.getFormData('image');
                
                if (this.currentEditingItem && this.currentEditingType === 'image') {
                    this.updateImage(this.currentEditingItem.id, formData);
                } else {
                    this.addImage(formData);
                }
                
                this.clearImageForm();
                this.displayImages();
            }

            handleAudioSubmit(e) {
                e.preventDefault();
                const formData = this.getFormData('audio');
                
                if (this.currentEditingItem && this.currentEditingType === 'audio') {
                    this.updateAudio(this.currentEditingItem.id, formData);
                } else {
                    this.addAudio(formData);
                }
                
                this.clearAudioForm();
                this.displayAudio();
            }

            handleContentSubmit(e) {
                e.preventDefault();
                const formData = this.getFormData('content');
                
                if (this.currentEditingItem && this.currentEditingType === 'content') {
                    this.updateContent(this.currentEditingItem.id, formData);
                } else {
                    this.addContent(formData);
                }
                
                this.clearContentForm();
                this.displayContent();
            }

            getFormData(type) {
                const data = {};
                const prefix = type;
                
                document.querySelectorAll(`[id^="${prefix}"]`).forEach(element => {
                    let key = element.id.replace(prefix, '');
                    key = key.charAt(0).toLowerCase() + key.slice(1);
                    
                    if (key && !key.includes('Form') && !key.includes('List')) {
                        if (element.type === 'checkbox') {
                            data[key] = element.checked;
                        } else {
                            data[key] = element.value;
                        }
                    }
                });
                
                return data;
            }

            addBook(book) {
                book.id = Date.now();
                book.created = new Date().toISOString();
                this.data.books.push(book);
                this.saveData();
            }

            addImage(image) {
                image.id = Date.now().toString();
                image.created = new Date().toISOString();
                this.data.images.push(image);
                this.saveData();
            }

            addAudio(audio) {
                audio.id = Date.now().toString();
                audio.created = new Date().toISOString();
                this.data.audio.push(audio);
                this.saveData();
            }

            addContent(content) {
                content.id = Date.now();
                content.created = new Date().toISOString();
                this.data.content.push(content);
                this.saveData();
            }

            displayBooks() {
                const books = this.data.books;
                const container = document.getElementById('booksList');
                if (!container) return;

                container.innerHTML = books.map(book => `
                    <div class="item-card">
                        <div class="item-header">
                            <div class="item-title">${this.escapeHtml(book.title)}</div>
                            <div class="item-actions">
                                <button class="btn btn-sm btn-secondary" onclick="dataManager.editBook(${book.id})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="dataManager.deleteBook(${book.id})">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </div>
                        </div>
                        <div class="item-categories">
                            <span class="item-category">${book.category || 'uncategorized'}</span>
                        </div>
                        <div class="item-meta">
                            <strong>Author:</strong> ${this.escapeHtml(book.author || 'Unknown')} | 
                            <strong>Year:</strong> ${this.escapeHtml(book.year || 'N/A')} | 
                            <strong>Language:</strong> ${this.escapeHtml(book.language || 'N/A')}
                        </div>
                        ${book.cover ? `<img src="${book.cover}" alt="${book.title}" style="max-width: 100px; height: auto; border-radius: 8px; margin: 10px 0;">` : ''}
                        ${book.description ? `<div class="item-description">${this.escapeHtml(book.description)}</div>` : ''}
                    </div>
                `).join('');
            }

            displayImages() {
                const images = this.data.images;
                const container = document.getElementById('imagesList');
                if (!container) return;

                container.innerHTML = images.map(image => `
                    <div class="item-card">
                        <div class="item-header">
                            <div class="item-title">${this.escapeHtml(image.title)}</div>
                            <div class="item-actions">
                                <button class="btn btn-sm btn-secondary" onclick="dataManager.editImage('${image.id}')">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="dataManager.deleteImage('${image.id}')">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </div>
                        </div>
                        <div class="item-categories">
                            <span class="item-category">${image.category || 'uncategorized'}</span>
                        </div>
                        ${image.src ? `<img src="${image.src}" alt="${image.alt || image.title}" style="max-width: 100%; max-height: 200px; object-fit: cover; border-radius: 8px; margin: 10px 0;">` : ''}
                        ${image.description ? `<div class="item-description">${this.escapeHtml(image.description)}</div>` : ''}
                    </div>
                `).join('');
            }

            displayAudio() {
                const audioList = this.data.audio;
                const container = document.getElementById('audioList');
                if (!container) return;

                container.innerHTML = audioList.map(audio => `
                    <div class="item-card">
                        <div class="item-header">
                            <div class="item-title">${this.escapeHtml(audio.title)}</div>
                            <div class="item-actions">
                                <button class="btn btn-sm btn-secondary" onclick="dataManager.editAudio('${audio.id}')">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="dataManager.deleteAudio('${audio.id}')">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </div>
                        </div>
                        <div class="item-categories">
                            <span class="item-category">${audio.category || 'uncategorized'}</span>
                        </div>
                        <div class="item-meta">
                            <strong>Artist:</strong> ${this.escapeHtml(audio.artist || 'Unknown')} | 
                            <strong>Duration:</strong> ${this.escapeHtml(audio.duration || 'N/A')}
                        </div>
                        ${audio.src ? `
                            <audio controls style="width: 100%; margin: 10px 0;">
                                <source src="${audio.src}" type="audio/mp3">
                                Your browser does not support the audio element.
                            </audio>
                        ` : ''}
                        ${audio.description ? `<div class="item-description">${this.escapeHtml(audio.description)}</div>` : ''}
                    </div>
                `).join('');
            }

            displayContent() {
                const content = this.data.content;
                const container = document.getElementById('contentList');
                if (!container) return;

                container.innerHTML = content.map(item => `
                    <div class="item-card">
                        <div class="item-header">
                            <div class="item-title">${this.escapeHtml(item.title)}</div>
                            <div class="item-actions">
                                <button class="btn btn-sm btn-secondary" onclick="dataManager.editContent(${item.id})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="dataManager.deleteContent(${item.id})">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </div>
                        </div>
                        <div class="item-categories">
                            <span class="item-category">${item.category || 'uncategorized'}</span>
                        </div>
                        <div class="item-meta">
                            <strong>Type:</strong> ${this.escapeHtml(item.type || 'N/A')} | 
                            <strong>Status:</strong> ${this.escapeHtml(item.status || 'N/A')} |
                            <strong>Created:</strong> ${item.created ? new Date(item.created).toLocaleDateString() : 'N/A'}
                        </div>
                        ${item.body ? `<div class="item-description">${this.escapeHtml(item.body.substring(0, 200))}${item.body.length > 200 ? '...' : ''}</div>` : ''}
                    </div>
                `).join('');
            }

            // CRUD operations for editing/deleting
            editBook(id) { console.log('Edit book:', id); }
            editImage(id) { console.log('Edit image:', id); }
            editAudio(id) { console.log('Edit audio:', id); }
            editContent(id) { console.log('Edit content:', id); }
            
            deleteBook(id) {
                if (confirm('Are you sure you want to delete this book?')) {
                    this.data.books = this.data.books.filter(book => book.id !== id);
                    this.saveData();
                    this.displayBooks();
                }
            }

            deleteImage(id) {
                if (confirm('Are you sure you want to delete this image?')) {
                    this.data.images = this.data.images.filter(image => image.id !== id);
                    this.saveData();
                    this.displayImages();
                }
            }

            deleteAudio(id) {
                if (confirm('Are you sure you want to delete this audio?')) {
                    this.data.audio = this.data.audio.filter(audio => audio.id !== id);
                    this.saveData();
                    this.displayAudio();
                }
            }

            deleteContent(id) {
                if (confirm('Are you sure you want to delete this content?')) {
                    this.data.content = this.data.content.filter(content => content.id !== id);
                    this.saveData();
                    this.displayContent();
                }
            }

            clearBookForm() {
                document.getElementById('bookForm').reset();
            }

            clearImageForm() {
                document.getElementById('imageForm').reset();
            }

            clearAudioForm() {
                document.getElementById('audioForm').reset();
            }

            clearContentForm() {
                document.getElementById('contentForm').reset();
            }

            searchBooks() { console.log('Search books'); }
            searchImages() { console.log('Search images'); }
            searchAudio() { console.log('Search audio'); }
            searchContent() { console.log('Search content'); }

            filterBooks() { console.log('Filter books'); }
            filterImages() { console.log('Filter images'); }
            filterAudio() { console.log('Filter audio'); }
            filterContent() { console.log('Filter content'); }

            exportData(type = 'all') {
                const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-').replace('T', '_');
                const filename = `${timestamp}_unified-${type}-data.json`;
                const exportData = type === 'all' ? this.data : { [type]: this.data[type] };
                
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', filename);
                linkElement.click();
                
                this.showMessage(`${type} exported successfully!`, 'success');
            }

            exportDataLegacy(type = 'all') {
                this.exportData(type);
            }

            exportCategories() {
                this.exportData('categories');
            }

            importData() {
                console.log('Import data functionality');
            }

            clearAllData() {
                if (confirm('Are you sure you want to clear all data?')) {
                    this.data = { books: [], images: [], audio: [], content: [] };
                    this.categories = { books: [], images: [], audio: [], content: [] };
                    this.saveData();
                    this.loadInitialData();
                    this.showMessage('All data cleared!', 'success');
                }
            }

            updateStats() {
                document.getElementById('totalBooks').textContent = this.data.books.length;
                document.getElementById('totalImages').textContent = this.data.images.length;
                document.getElementById('totalAudio').textContent = this.data.audio.length;
                document.getElementById('totalContent').textContent = this.data.content.length;
            }

            updatePreview() {
                const previewElement = document.getElementById('dataPreview');
                if (previewElement) {
                    previewElement.textContent = JSON.stringify(this.data, null, 2);
                }
            }

            loadInitialData() {
                this.displayBooks();
                this.displayImages();
                this.displayAudio();
                this.displayContent();
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            showMessage(message, type = 'info') {
                const existingMessages = document.querySelectorAll('.message');
                existingMessages.forEach(msg => msg.remove());

                const messageDiv = document.createElement('div');
                messageDiv.className = `message message-${type}`;
                
                let icon = 'fas fa-info-circle';
                if (type === 'success') icon = 'fas fa-check-circle';
                if (type === 'error') icon = 'fas fa-exclamation-circle';
                if (type === 'warning') icon = 'fas fa-exclamation-triangle';
                
                messageDiv.innerHTML = `<i class="${icon}"></i> ${message}`;
                
                const container = document.querySelector('.container');
                container.insertBefore(messageDiv, container.children[1]);
                
                setTimeout(() => {
                    messageDiv.remove();
                }, 5000);
            }
        }

        // Global functions
        function showTab(tabName) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function addCategory(type, isGlobal = false) {
            dataManager.addCategory(type, isGlobal);
        }

        function searchBooks() { dataManager.searchBooks(); }
        function searchImages() { dataManager.searchImages(); }
        function searchAudio() { dataManager.searchAudio(); }
        function searchContent() { dataManager.searchContent(); }

        function filterBooks() { dataManager.filterBooks(); }
        function filterImages() { dataManager.filterImages(); }
        function filterAudio() { dataManager.filterAudio(); }
        function filterContent() { dataManager.filterContent(); }

        function clearBookForm() { dataManager.clearBookForm(); }
        function clearImageForm() { dataManager.clearImageForm(); }
        function clearAudioForm() { dataManager.clearAudioForm(); }
        function clearContentForm() { dataManager.clearContentForm(); }

        function exportAllData() { dataManager.exportData('all'); }
        function exportBooks() { dataManager.exportData('books'); }
        function exportImages() { dataManager.exportData('images'); }
        function exportAudio() { dataManager.exportData('audio'); }
        function exportContent() { dataManager.exportData('content'); }
        function exportAllDataLegacy() { dataManager.exportDataLegacy('all'); }
        function exportCategories() { dataManager.exportCategories(); }
        function importData() { dataManager.importData(); }
        function clearAllData() { dataManager.clearAllData(); }

        let dataManager;

        document.addEventListener('DOMContentLoaded', function() {
            dataManager = new EnhancedUnifiedDataManager();
            window.dataManager = dataManager;
        });
    </script>
</body>
</html>